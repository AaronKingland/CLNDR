<<<<<<< HEAD
/*! clndr.min.js v1.2.0 2014-02-16 */
!function(a,b,c,d){function e(b,c){if(this.element=b,this.options=a.extend(!0,{},h,c),this.options.events.length&&(this.options.events=this.options.multiDayEvents?this.addMultiDayMomentObjectsToEvents(this.options.events):this.addMomentObjectToEvents(this.options.events)),this.options.lengthOfTime.months||this.options.lengthOfTime.days?this.options.lengthOfTime.months?(this.options.lengthOfTime.days=null,this.intervalStart=this.options.lengthOfTime.startDate?moment(this.options.lengthOfTime.startDate).startOf("month"):this.options.startWithMonth?moment(this.options.startWithMonth).startOf("month"):moment().startOf("month"),this.intervalEnd=moment(this.intervalStart).add("months",this.options.lengthOfTime.months).subtract("days",1),this.month=this.intervalStart.clone()):this.options.lengthOfTime.days&&(this.intervalStart=this.options.lengthOfTime.startDate?moment(this.options.lengthOfTime.startDate).startOf("day"):moment().weekday(0).startOf("day"),this.intervalEnd=moment(this.intervalStart).add("days",this.options.lengthOfTime.days-1).endOf("day"),this.month=this.intervalStart.clone()):(this.month=moment().startOf("month"),this.intervalStart=moment(this.month),this.intervalEnd=moment(this.month).endOf("month")),this.options.startWithMonth&&(this.month=moment(this.options.startWithMonth).startOf("month"),this.intervalStart=moment(this.month),this.intervalEnd=moment(this.month).endOf("month")),this.options.constraints){if(this.options.constraints.startDate){var d=moment(this.options.constraints.startDate);this.intervalStart.isBefore(d,"month")&&(this.intervalStart.set("month",d.month()).set("year",d.year()),this.month.set("month",d.month()).set("year",d.year()))}if(this.options.constraints.endDate){var e=moment(this.options.constraints.endDate);this.intervalEnd.isAfter(e,"month")&&(this.intervalEnd.set("month",e.month()).set("year",e.year()),this.month.set("month",e.month()).set("year",e.year()))}}this._defaults=h,this._name=g,this.init()}var f="<div class='clndr-controls'><div class='clndr-control-button'><span class='clndr-previous-button'>previous</span></div><div class='month'><%= month %> <%= year %></div><div class='clndr-control-button rightalign'><span class='clndr-next-button'>next</span></div></div><table class='clndr-table' border='0' cellspacing='0' cellpadding='0'><thead><tr class='header-days'><% for(var i = 0; i < daysOfTheWeek.length; i++) { %><td class='header-day'><%= daysOfTheWeek[i] %></td><% } %></tr></thead><tbody><% for(var i = 0; i < numberOfRows; i++){ %><tr><% for(var j = 0; j < 7; j++){ %><% var d = j + i * 7; %><td class='<%= days[d].classes %>'><div class='day-contents'><%= days[d].day %></div></td><% } %></tr><% } %></tbody></table>",g="clndr",h={template:f,weekOffset:0,startWithMonth:null,clickEvents:{click:null,nextMonth:null,previousMonth:null,nextYear:null,previousYear:null,today:null,onMonthChange:null,onYearChange:null},targets:{nextButton:"clndr-next-button",previousButton:"clndr-previous-button",nextYearButton:"clndr-next-year-button",previousYearButton:"clndr-previous-year-button",todayButton:"clndr-today-button",day:"day",empty:"empty"},events:[],extras:null,dateParameter:"date",multiDayEvents:null,doneRendering:null,render:null,daysOfTheWeek:null,showAdjacentMonths:!0,adjacentDaysChangeMonth:!1,ready:null,constraints:null,forceSixRows:null,lengthOfTime:{months:null,days:null,interval:1}};e.prototype.init=function(){if(this.daysOfTheWeek=this.options.daysOfTheWeek||[],!this.options.daysOfTheWeek){this.daysOfTheWeek=[];for(var b=0;7>b;b++)this.daysOfTheWeek.push(moment().weekday(b).format("dd").charAt(0))}if(this.options.weekOffset&&(this.daysOfTheWeek=this.shiftWeekdayLabels(this.options.weekOffset)),!a.isFunction(this.options.render)){if(this.options.render=null,"undefined"==typeof _)throw new Error("Underscore was not found. Please include underscore.js OR provide a custom render function.");this.compiledClndrTemplate=_.template(this.options.template)}a(this.element).html("<div class='clndr'></div>"),this.calendarContainer=a(".clndr",this.element),this.bindEvents(),this.render(),this.options.ready&&this.options.ready.apply(this,[])},e.prototype.shiftWeekdayLabels=function(a){for(var b=this.daysOfTheWeek,c=0;a>c;c++)b.push(b.shift());return b},e.prototype.createDaysObject=function(b,c){daysArray=[];{var d=b.clone();c.diff(b,"days")}if(this._currentIntervalStart=b.clone(),this.eventsLastMonth=[],this.eventsThisInterval=[],this.eventsNextMonth=[],this.options.events.length&&(this.eventsThisInterval=a(this.options.events).filter(function(){return this._clndrEndDateObject.isBefore(b)||this._clndrStartDateObject.isAfter(c)?!1:!0}).toArray(),this.options.showAdjacentMonths)){var e=b.clone().subtract("months",1).startOf("month"),f=e.clone().endOf("month"),g=c.clone().add("months",1).startOf("month"),h=g.clone().endOf("month");this.eventsLastMonth=a(this.options.events).filter(function(){return this._clndrEndDateObject.isBefore(e)||this._clndrStartDateObject.isAfter(f)?!1:!0}).toArray(),this.eventsNextMonth=a(this.options.events).filter(function(){return this._clndrEndDateObject.isBefore(g)||this._clndrStartDateObject.isAfter(h)?!1:!0}).toArray()}if(!this.options.lengthOfTime.days){var i=d.weekday()-this.options.weekOffset;if(0>i&&(i+=7),this.options.showAdjacentMonths)for(var j=0;i>j;j++){var k=moment([b.year(),b.month(),j-i+1]);daysArray.push(this.createDayObject(k,this.eventsLastMonth))}else for(var j=0;i>j;j++)daysArray.push(this.calendarDay({classes:this.options.targets.empty+" last-month"}))}for(var l=b.clone();l.isBefore(c)||l.isSame(c,"day");)daysArray.push(this.createDayObject(l.clone(),this.eventsThisInterval)),l.add("days",1);if(!this.options.lengthOfTime.days)for(;daysArray.length%7!==0;)this.options.showAdjacentMonths?daysArray.push(this.createDayObject(l.clone(),this.eventsNextMonth)):daysArray.push(this.calendarDay({classes:this.options.targets.empty+" next-month"})),l.add("days",1);if(this.options.forceSixRows&&42!==daysArray.length)for(;daysArray.length<42;)this.options.showAdjacentMonths?(daysArray.push(this.createDayObject(l.clone(),this.eventsNextMonth)),l.add("days",1)):daysArray.push(this.calendarDay({classes:this.options.targets.empty+" next-month"}));return daysArray},e.prototype.createDayObject=function(a,b){var c=[],e=moment();!a.isValid()&&a.hasOwnProperty("_d")&&a._d!=d&&(a=moment(a._d));var f=0,g=b.length;for(f;g>f;f++){var h=b[f]._clndrStartDateObject,i=b[f]._clndrEndDateObject;(a.isSame(h,"day")||a.isAfter(h,"day"))&&(a.isSame(i,"day")||a.isBefore(i,"day"))&&c.push(b[f])}var j="";return e.format("YYYY-MM-DD")==a.format("YYYY-MM-DD")&&(j+=" today"),a.isBefore(e,"day")&&(j+=" past"),c.length&&(j+=" event"),this.options.lengthOfTime.days||(this._currentIntervalStart.month()>a.month()?(j+=" adjacent-month",j+=this._currentIntervalStart.year()===a.year()?" last-month":" next-month"):this._currentIntervalStart.month()<a.month()&&(j+=" adjacent-month",j+=this._currentIntervalStart.year()===a.year()?" next-month":" last-month")),this.options.constraints&&(this.options.constraints.startDate&&a.isBefore(moment(this.options.constraints.startDate))&&(j+=" inactive"),this.options.constraints.endDate&&a.isAfter(moment(this.options.constraints.endDate))&&(j+=" inactive")),j+=" calendar-day-"+a.format("YYYY-MM-DD"),j+=" calendar-dow-"+a.weekday(),this.calendarDay({day:a.date(),classes:this.options.targets.day+j,events:c,date:a})},e.prototype.render=function(){this.calendarContainer.children().remove();var a={};if(this.options.lengthOfTime.days){var b=this.createDaysObject(this.intervalStart.clone(),this.intervalEnd.clone());a={daysOfTheWeek:this.daysOfTheWeek,days:b,intervalStart:this.intervalStart.clone(),intervalEnd:this.intervalEnd.clone(),eventsThisInterval:this.eventsThisInterval,extras:this.options.extras}}else if(this.options.lengthOfTime.months){var c=[];for(i=0;i<this.options.lengthOfTime.months;i++){var d=this.intervalStart.clone().add("months",i),e=d.clone().endOf("month");c.push({month:d,days:this.createDaysObject(d,e)})}a={daysOfTheWeek:this.daysOfTheWeek,months:c,intervalStart:this.intervalStart,intervalEnd:this.intervalEnd,eventsThisInterval:this.eventsThisInterval,eventsLastMonth:this.eventsLastMonth,eventsNextMonth:this.eventsNextMonth,extras:this.options.extras}}else var b=this.createDaysObject(this.month.clone().startOf("month"),this.month.clone().endOf("month")),a=(this.month,{daysOfTheWeek:this.daysOfTheWeek,numberOfRows:Math.ceil(b.length/7),days:b,month:this.month.format("MMMM"),year:this.month.year(),eventsThisMonth:this.eventsThisMonth,eventsLastMonth:this.eventsLastMonth,eventsNextMonth:this.eventsNextMonth,extras:this.options.extras});if(this.options.render?this.calendarContainer.html(this.options.render.apply(this,[a])):this.calendarContainer.html(this.compiledClndrTemplate(a)),this.options.constraints){for(target in this.options.targets)target!=this.options.targets.day&&this.element.find("."+this.options.targets[target]).toggleClass("inactive",!1);var f=null,g=null;this.options.constraints.startDate&&(f=moment(this.options.constraints.startDate)),this.options.constraints.endDate&&(g=moment(this.options.constraints.endDate)),f&&(f.isAfter(this.intervalStart)||f.isSame(this.intervalStart,"day"))&&this.element.find("."+this.options.targets.previousButton).toggleClass("inactive",!0),g&&(g.isBefore(this.intervalEnd)||g.isSame(this.intervalEnd,"day"))&&this.element.find("."+this.options.targets.nextButton).toggleClass("inactive",!0),f&&f.isAfter(this.intervalStart.clone().subtract("years",1))&&this.element.find("."+this.options.targets.previousYearButton).toggleClass("inactive",!0),g&&g.isBefore(this.intervalEnd.clone().add("years",1))&&this.element.find("."+this.options.targets.nextYearButton).toggleClass("inactive",!0),(f&&f.isAfter(moment(),"month")||g&&g.isBefore(moment(),"month"))&&this.element.find("."+this.options.targets.today).toggleClass("inactive",!0)}this.options.doneRendering&&this.options.doneRendering.apply(this,[])},e.prototype.bindEvents=function(){var b=a(this.element),c=this;b.on("click","."+this.options.targets.day,function(b){if(c.options.clickEvents.click){var d=c.buildTargetObject(b.currentTarget,!0);c.options.clickEvents.click.apply(c,[d])}c.options.adjacentDaysChangeMonth&&(a(b.currentTarget).is(".last-month")?c.backActionWithContext(c):a(b.currentTarget).is(".next-month")&&c.forwardActionWithContext(c))}),b.on("click","."+this.options.targets.empty,function(b){if(c.options.clickEvents.click){var d=c.buildTargetObject(b.currentTarget,!1);c.options.clickEvents.click.apply(c,[d])}c.options.adjacentDaysChangeMonth&&(a(b.currentTarget).is(".last-month")?c.backActionWithContext(c):a(b.currentTarget).is(".next-month")&&c.forwardActionWithContext(c))}),b.on("click","."+this.options.targets.previousButton,{context:this},this.backAction).on("click","."+this.options.targets.nextButton,{context:this},this.forwardAction).on("click","."+this.options.targets.todayButton,{context:this},this.todayAction).on("click","."+this.options.targets.nextYearButton,{context:this},this.nextYearAction).on("click","."+this.options.targets.previousYearButton,{context:this},this.previousYearAction)},e.prototype.buildTargetObject=function(b,c){var d={element:b,events:[],date:null};if(c){var e,f=b.className.indexOf("calendar-day-");0!==f?(e=b.className.substring(f+13,f+23),d.date=moment(e)):d.date=null,this.options.events&&(d.events=this.options.multiDayEvents?a.makeArray(a(this.options.events).filter(function(){return(d.date.isSame(this._clndrStartDateObject,"day")||d.date.isAfter(this._clndrStartDateObject,"day"))&&(d.date.isSame(this._clndrEndDateObject,"day")||d.date.isBefore(this._clndrEndDateObject,"day"))})):a.makeArray(a(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM-DD")==e})))}return d},e.prototype.forwardAction=function(a){var b=a.data.context;b.forwardActionWithContext(b)},e.prototype.backAction=function(a){var b=a.data.context;b.backActionWithContext(b)},e.prototype.backActionWithContext=function(a){if(!a.element.find("."+a.options.targets.previousButton).hasClass("inactive")){var b=null;a.options.lengthOfTime.days?(a.intervalStart.subtract("days",a.options.lengthOfTime.interval).startOf("day"),a.intervalEnd=a.intervalStart.clone().add("days",a.options.lengthOfTime.days-1).endOf("day"),a.month=a.intervalStart.clone()):(a.intervalStart.subtract("months",a.options.lengthOfTime.interval).startOf("month"),a.intervalEnd=a.intervalStart.clone().add("months",a.options.lengthOfTime.months||a.options.lengthOfTime.interval).subtract("days",1).endOf("month"),a.options.lengthOfTime.months||(b=!a.month.isSame(moment(a.month).subtract("months",1),"year")),a.month=a.intervalStart.clone()),a.render(),a.options.lengthOfTime.days||a.options.lengthOfTime.months?(a.options.clickEvents.previousInterval&&a.options.clickEvents.previousInterval.apply(a,[moment(a.intervalStart),moment(a.intervalEnd)]),a.options.clickEvents.onIntervalChange&&a.options.clickEvents.onIntervalChange.apply(a,[moment(a.intervalStart),moment(a.intervalEnd)])):(a.options.clickEvents.previousMonth&&a.options.clickEvents.previousMonth.apply(a,[moment(a.month)]),a.options.clickEvents.onMonthChange&&a.options.clickEvents.onMonthChange.apply(a,[moment(a.month)]),b&&a.options.clickEvents.onYearChange&&a.options.clickEvents.onYearChange.apply(a,[moment(a.month)]))}},e.prototype.forwardActionWithContext=function(a){if(!a.element.find("."+a.options.targets.nextButton).hasClass("inactive")){var b=null;a.options.lengthOfTime.days?(a.intervalStart.add("days",a.options.lengthOfTime.interval).startOf("day"),a.intervalEnd=a.intervalStart.clone().add("days",a.options.lengthOfTime.days-1).endOf("day"),a.month=a.intervalStart.clone()):(a.intervalStart.add("months",a.options.lengthOfTime.interval).startOf("month"),a.intervalEnd=a.intervalStart.clone().add("months",a.options.lengthOfTime.months||a.options.lengthOfTime.interval).subtract("days",1).endOf("month"),a.options.lengthOfTime.months||(b=!a.month.isSame(moment(a.month).add("months",1),"year")),a.month=a.intervalStart.clone()),a.render(),a.options.lengthOfTime.days||a.options.lengthOfTime.months?(a.options.clickEvents.nextInterval&&a.options.clickEvents.nextInterval.apply(a,[moment(a.intervalStart),moment(a.intervalEnd)]),a.options.clickEvents.onIntervalChange&&a.options.clickEvents.onIntervalChange.apply(a,[moment(a.intervalStart),moment(a.intervalEnd)])):(a.options.clickEvents.previousMonth&&a.options.clickEvents.previousMonth.apply(a,[moment(a.month)]),a.options.clickEvents.onMonthChange&&a.options.clickEvents.onMonthChange.apply(a,[moment(a.month)]),b&&a.options.clickEvents.onYearChange&&a.options.clickEvents.onYearChange.apply(a,[moment(a.month)]))}},e.prototype.todayAction=function(a){var b=a.data.context,c=!b.month.isSame(moment(),"month"),d=!b.month.isSame(moment(),"year");b.month=moment().startOf("month"),b.options.lengthOfTime.days?(b.intervalStart=b.options.lengthOfTime.startDate?moment().weekday(b.options.lengthOfTime.startDate.weekday()).startOf("day"):moment().weekday(0).startOf("day"),b.intervalEnd=b.intervalStart.clone().add("days",b.options.lengthOfTime.days-1).endOf("day")):b.options.lengthOfTime.months?(b.intervalStart=moment().startOf("month"),b.intervalEnd=b.intervalStart.clone().add("months",b.options.lengthOfTime.months||b.options.lengthOfTime.interval).subtract("days",1).endOf("month")):c&&(b.render(),b.options.clickEvents.today&&b.options.clickEvents.today.apply(b,[moment(b.month)]),b.options.clickEvents.onMonthChange&&b.options.clickEvents.onMonthChange.apply(b,[moment(b.month)]),d&&b.options.clickEvents.onYearChange&&b.options.clickEvents.onYearChange.apply(b,[moment(b.month)])),(b.options.lengthOfTime.days||b.options.lengthOfTime.months)&&(b.render(),b.options.clickEvents.today&&b.options.clickEvents.today.apply(b,[moment(b.month)]),b.options.clickEvents.onIntervalChange&&b.options.clickEvents.onIntervalChange.apply(b,[moment(b.intervalStart),moment(b.intervalEnd)]))},e.prototype.nextYearAction=function(a){var b=a.data.context;b.element.find("."+b.options.targets.nextYearButton).hasClass("inactive")||(b.month.add("years",1),b.intervalStart.add("years",1),b.intervalEnd.add("years",1),b.render(),b.options.clickEvents.nextYear&&b.options.clickEvents.nextYear.apply(b,[moment(b.month)]),b.options.lengthOfTime.days||b.options.lengthOfTime.months?b.options.clickEvents.onIntervalChange&&b.options.clickEvents.onIntervalChange.apply(b,[moment(b.intervalStart),moment(b.intervalEnd)]):(b.options.clickEvents.onMonthChange&&b.options.clickEvents.onMonthChange.apply(b,[moment(b.month)]),b.options.clickEvents.onYearChange&&b.options.clickEvents.onYearChange.apply(b,[moment(b.month)])))},e.prototype.previousYearAction=function(a){var b=a.data.context;console.log(b.element.find("."+b.options.targets.previousYear)),b.element.find("."+b.options.targets.previousYearButton).hasClass("inactive")||(b.month.subtract("years",1),b.intervalStart.subtract("years",1),b.intervalEnd.subtract("years",1),b.render(),b.options.clickEvents.previousYear&&b.options.clickEvents.previousYear.apply(b,[moment(b.month)]),b.options.lengthOfTime.days||b.options.lengthOfTime.months?b.options.clickEvents.onIntervalChange&&b.options.clickEvents.onIntervalChange.apply(b,[moment(b.intervalStart),moment(b.intervalEnd)]):(b.options.clickEvents.onMonthChange&&b.options.clickEvents.onMonthChange.apply(b,[moment(b.month)]),b.options.clickEvents.onYearChange&&b.options.clickEvents.onYearChange.apply(b,[moment(b.month)])))},e.prototype.forward=function(a){return this.options.lengthOfTime.days?(this.intervalStart.add("days",this.options.lengthOfTime.interval).startOf("day"),this.intervalEnd=this.intervalStart.clone().add("days",this.options.lengthOfTime.days-1).endOf("day"),this.month=this.intervalStart.clone()):(this.intervalStart.add("months",this.options.lengthOfTime.interval).startOf("month"),this.intervalEnd=this.intervalStart.clone().add("months",this.options.lengthOfTime.months||this.options.lengthOfTime.interval).subtract("days",1).endOf("month"),this.month=this.intervalStart.clone()),this.render(),a&&a.withCallbacks&&(this.options.lengthOfTime.days||this.options.lengthOfTime.months?this.options.clickEvents.onIntervalChange&&this.options.clickEvents.onIntervalChange.apply(this,[moment(this.intervalStart),moment(this.intervalEnd)]):(this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[moment(this.month)]),0===this.month.month()&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)]))),this},e.prototype.back=function(a){return this.options.lengthOfTime.days?(this.intervalStart.subtract("days",this.options.lengthOfTime.interval).startOf("day"),this.intervalEnd=this.intervalStart.clone().add("days",this.options.lengthOfTime.days-1).endOf("day"),this.month=this.intervalStart.clone()):(this.intervalStart.subtract("months",this.options.lengthOfTime.interval).startOf("month"),this.intervalEnd=this.intervalStart.clone().add("months",this.options.lengthOfTime.months||this.options.lengthOfTime.interval).subtract("days",1).endOf("month"),this.month=this.intervalStart.clone()),this.render(),a&&a.withCallbacks&&(this.options.lengthOfTime.days||this.options.lengthOfTime.months?this.options.clickEvents.onIntervalChange&&this.options.clickEvents.onIntervalChange.apply(this,[moment(this.intervalStart),moment(this.intervalEnd)]):(this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[moment(this.month)]),11===this.month.month()&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)]))),this},e.prototype.next=function(a){return this.forward(a),this},e.prototype.previous=function(a){return this.back(a),this},e.prototype.setMonth=function(a,b){return this.options.lengthOfTime.days||this.options.lengthOfTime.months?console.log("You are using a custom date interval; use Clndr.setIntervalStart(startDate) instead."):(this.month.month(a),this.render(),b&&b.withCallbacks&&this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[moment(this.month)])),this},e.prototype.setIntervalStart=function(a,b){return this.options.lengthOfTime.days?(this.intervalStart=moment(a).startOf("day"),this.intervalEnd=this.intervalStart.clone().add("days",this.options.lengthOfTime.days-1).endOf("day")):this.options.lengthOfTime.months&&(this.intervalStart=moment(newMonth).startOf("month"),this.intervalEnd=this.intervalStart.clone().add("months",this.options.lengthOfTime.months||this.options.lengthOfTime.interval).subtract("days",1).endOf("month"),this.month=this.intervalStart.clone()),this.options.lengthOfTime.days||this.options.lengthOfTime.months?(this.render(),b&&b.withCallbacks&&this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[moment(this.month)])):console.log("You are using a custom date interval; use Clndr.setIntervalStart(startDate) instead."),this},e.prototype.nextYear=function(a){return this.month.add("years",1),self.intervalStart.add("years",1),self.intervalEnd.add("years",1),this.render(),a&&a.withCallbacks&&(this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)]),self.options.clickEvents.onIntervalChange&&self.options.clickEvents.onIntervalChange.apply(self,[moment(self.intervalStart),moment(self.intervalEnd)])),this},e.prototype.previousYear=function(a){return this.month.subtract("years",1),self.intervalStart.subtract("years",1),self.intervalEnd.subtract("years",1),this.render(),a&&a.withCallbacks&&(this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)]),self.options.clickEvents.onIntervalChange&&self.options.clickEvents.onIntervalChange.apply(self,[moment(self.intervalStart),moment(self.intervalEnd)])),this},e.prototype.setYear=function(a,b){return this.month.year(a),self.intervalStart.year(a),self.intervalEnd.year(a),this.render(),b&&b.withCallbacks&&(this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)]),self.options.clickEvents.onIntervalChange&&self.options.clickEvents.onIntervalChange.apply(self,[moment(self.intervalStart),moment(self.intervalEnd)])),this},e.prototype.setEvents=function(a){return this.options.events=this.options.multiDayEvents?this.addMultiDayMomentObjectsToEvents(a):this.addMomentObjectToEvents(a),this.render(),this},e.prototype.addEvents=function(b){return this.options.events=this.options.multiDayEvents?a.merge(this.options.events,this.addMultiDayMomentObjectsToEvents(b)):a.merge(this.options.events,this.addMomentObjectToEvents(b)),this.render(),this},e.prototype.addMomentObjectToEvents=function(a){var b=this,c=0,d=a.length;for(c;d>c;c++)a[c]._clndrStartDateObject=moment(a[c][b.options.dateParameter]),a[c]._clndrEndDateObject=moment(a[c][b.options.dateParameter]);return a},e.prototype.addMultiDayMomentObjectsToEvents=function(a){var b=this,c=0,d=a.length;for(c;d>c;c++)a[c]._clndrStartDateObject=moment(a[c][b.options.multiDayEvents.startDate]),a[c]._clndrEndDateObject=moment(a[c][b.options.multiDayEvents.endDate]);return a},e.prototype.calendarDay=function(b){var c={day:"",classes:this.options.targets.empty,events:[],date:null};return a.extend({},c,b)},a.fn.clndr=function(a){if(1===this.length){if(!this.data("plugin_clndr")){var b=new e(this,a);return this.data("plugin_clndr",b),b}}else if(this.length>1)throw new Error("CLNDR does not support multiple elements yet. Make sure your clndr selector returns only one element.")}}(jQuery,window,document);
=======
/*! clndr.min.js v1.2.10 2015-03-11 */
!function(a){"function"==typeof define&&define.amd?define(["jquery","moment"],a):"object"==typeof exports?a(require("jquery"),require("moment")):a(jQuery,moment)}(function(a,b){function c(c,d){if(this.element=c,this.options=a.extend(!0,{},f,d),this.options.events.length&&(this.options.events=this.options.multiDayEvents?this.addMultiDayMomentObjectsToEvents(this.options.events):this.addMomentObjectToEvents(this.options.events)),this.month=this.options.startWithMonth?b(this.options.startWithMonth).startOf("month"):b().startOf("month"),this.options.constraints){if(this.options.constraints.startDate){var g=b(this.options.constraints.startDate);this.month.isBefore(g,"month")&&(this.month.set("month",g.month()),this.month.set("year",g.year()))}if(this.options.constraints.endDate){var h=b(this.options.constraints.endDate);this.month.isAfter(h,"month")&&this.month.set("month",h.month()).set("year",h.year())}}this._defaults=f,this._name=e,this.init()}var d="<div class='clndr-controls'><div class='clndr-control-button'><span class='clndr-previous-button'>previous</span></div><div class='month'><%= month %> <%= year %></div><div class='clndr-control-button rightalign'><span class='clndr-next-button'>next</span></div></div><table class='clndr-table' border='0' cellspacing='0' cellpadding='0'><thead><tr class='header-days'><% for(var i = 0; i < daysOfTheWeek.length; i++) { %><td class='header-day'><%= daysOfTheWeek[i] %></td><% } %></tr></thead><tbody><% for(var i = 0; i < numberOfRows; i++){ %><tr><% for(var j = 0; j < 7; j++){ %><% var d = j + i * 7; %><td class='<%= days[d].classes %>'><div class='day-contents'><%= days[d].day %></div></td><% } %></tr><% } %></tbody></table>",e="clndr",f={template:d,weekOffset:0,startWithMonth:null,clickEvents:{click:null,nextMonth:null,previousMonth:null,nextYear:null,previousYear:null,today:null,onMonthChange:null,onYearChange:null},targets:{nextButton:"clndr-next-button",previousButton:"clndr-previous-button",nextYearButton:"clndr-next-year-button",previousYearButton:"clndr-previous-year-button",todayButton:"clndr-today-button",day:"day",empty:"empty"},classes:{today:"today",event:"event",past:"past",lastMonth:"last-month",nextMonth:"next-month",adjacentMonth:"adjacent-month",inactive:"inactive"},events:[],extras:null,dateParameter:"date",multiDayEvents:null,doneRendering:null,render:null,daysOfTheWeek:null,showAdjacentMonths:!0,adjacentDaysChangeMonth:!1,ready:null,constraints:null,forceSixRows:null};c.prototype.init=function(){if(this.daysOfTheWeek=this.options.daysOfTheWeek||[],!this.options.daysOfTheWeek){this.daysOfTheWeek=[];for(var c=0;7>c;c++)this.daysOfTheWeek.push(b().weekday(c).format("dd").charAt(0))}if(this.options.weekOffset&&(this.daysOfTheWeek=this.shiftWeekdayLabels(this.options.weekOffset)),!a.isFunction(this.options.render)){if(this.options.render=null,"undefined"==typeof _)throw new Error("Underscore was not found. Please include underscore.js OR provide a custom render function.");this.compiledClndrTemplate=_.template(this.options.template)}a(this.element).html("<div class='clndr'></div>"),this.calendarContainer=a(".clndr",this.element),this.bindEvents(),this.render(),this.options.ready&&this.options.ready.apply(this,[])},c.prototype.shiftWeekdayLabels=function(a){for(var b=this.daysOfTheWeek,c=0;a>c;c++)b.push(b.shift());return b},c.prototype.createDaysObject=function(c){var d=[],e=c.startOf("month");if(this.eventsLastMonth=[],this.eventsThisMonth=[],this.eventsNextMonth=[],this.options.events.length)if(this.options.multiDayEvents){if(this.eventsThisMonth=a(this.options.events).filter(function(){return this._clndrStartDateObject.format("YYYY-MM")===c.format("YYYY-MM")||this._clndrEndDateObject.format("YYYY-MM")===c.format("YYYY-MM")?!0:this._clndrStartDateObject.format("YYYY-MM")<=c.format("YYYY-MM")&&this._clndrEndDateObject.format("YYYY-MM")>=c.format("YYYY-MM")?!0:!1}).toArray(),this.options.showAdjacentMonths){var f=c.clone().subtract(1,"months"),g=c.clone().add(1,"months");this.eventsLastMonth=a(this.options.events).filter(function(){return this._clndrStartDateObject.format("YYYY-MM")===f.format("YYYY-MM")||this._clndrEndDateObject.format("YYYY-MM")===f.format("YYYY-MM")?!0:this._clndrStartDateObject.format("YYYY-MM")<=f.format("YYYY-MM")&&this._clndrEndDateObject.format("YYYY-MM")>=f.format("YYYY-MM")?!0:!1}).toArray(),this.eventsNextMonth=a(this.options.events).filter(function(){return this._clndrStartDateObject.format("YYYY-MM")===g.format("YYYY-MM")||this._clndrEndDateObject.format("YYYY-MM")===g.format("YYYY-MM")?!0:this._clndrStartDateObject.format("YYYY-MM")<=g.format("YYYY-MM")&&this._clndrEndDateObject.format("YYYY-MM")>=g.format("YYYY-MM")?!0:!1}).toArray()}}else if(this.eventsThisMonth=a(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM")==c.format("YYYY-MM")}).toArray(),this.options.showAdjacentMonths){var f=c.clone().subtract(1,"months"),g=c.clone().add(1,"months");this.eventsLastMonth=a(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM")==f.format("YYYY-MM")}).toArray(),this.eventsNextMonth=a(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM")==g.format("YYYY-MM")}).toArray()}var h=e.weekday()-this.options.weekOffset;if(0>h&&(h+=7),this.options.showAdjacentMonths)for(var i=0;h>i;i++){var j=b([c.year(),c.month(),i-h+1]);d.push(this.createDayObject(j,this.eventsLastMonth))}else for(var i=0;h>i;i++)d.push(this.calendarDay({classes:this.options.targets.empty+" "+this.options.classes.lastMonth}));for(var k=e.daysInMonth(),i=1;k>=i;i++){var j=b([c.year(),c.month(),i]);d.push(this.createDayObject(j,this.eventsThisMonth))}for(var i=1;d.length%7!==0;){if(this.options.showAdjacentMonths){var j=b([c.year(),c.month(),k+i]);d.push(this.createDayObject(j,this.eventsNextMonth))}else d.push(this.calendarDay({classes:this.options.targets.empty+" "+this.options.classes.nextMonth}));i++}if(this.options.forceSixRows&&42!==d.length)for(var l=b(d[d.length-1].date).add(1,"days");d.length<42;)this.options.showAdjacentMonths?(d.push(this.createDayObject(b(l),this.eventsNextMonth)),l.add(1,"days")):d.push(this.calendarDay({classes:this.options.targets.empty+" "+this.options.classes.nextMonth}));return d},c.prototype.createDayObject=function(a,c){var d=[],e=b(),f=this,g=0,h=c.length;for(g;h>g;g++){var i,j,k=c[g];f.options.multiDayEvents?(i=k._clndrStartDateObject,j=k._clndrEndDateObject):i=k._clndrDateObject,f.options.multiDayEvents&&j.diff(i,!1)?(a.isSame(i,"day")||a.isAfter(i,"day"))&&(a.isSame(j,"day")||a.isBefore(j,"day"))&&d.push(k):a.isSame(i,"day")&&d.push(k)}var l="";return e.format("YYYY-MM-DD")==a.format("YYYY-MM-DD")&&(l+=" "+this.options.classes.today),a.isBefore(e,"day")&&(l+=" "+this.options.classes.past),d.length&&(l+=" "+this.options.classes.event),this.month.month()>a.month()?(l+=" "+this.options.classes.adjacentMonth,l+=this.month.year()===a.year()?" "+this.options.classes.lastMonth:" "+this.options.classes.nextMonth):this.month.month()<a.month()&&(l+=" "+this.options.classes.adjacentMonth,l+=this.month.year()===a.year()?" "+this.options.classes.nextMonth:" "+this.options.classes.lastMonth),this.options.constraints&&(this.options.constraints.startDate&&a.isBefore(b(this.options.constraints.startDate))&&(l+=" "+this.options.classes.inactive),this.options.constraints.endDate&&a.isAfter(b(this.options.constraints.endDate))&&(l+=" "+this.options.classes.inactive)),!a.isValid()&&a.hasOwnProperty("_d")&&void 0!=a._d&&(a=b(a._d)),l+=" calendar-day-"+a.format("YYYY-MM-DD"),l+=" calendar-dow-"+a.weekday(),this.calendarDay({day:a.date(),classes:this.options.targets.day+l,events:d,date:a})},c.prototype.render=function(){this.calendarContainer.children().remove();var a=this.createDaysObject(this.month),c=(this.month,{daysOfTheWeek:this.daysOfTheWeek,numberOfRows:Math.ceil(a.length/7),days:a,previousMonth:this.month.clone().subtract(1,"month").format("MMMM"),month:this.month.format("MMMM"),nextMonth:this.month.clone().add(1,"month").format("MMMM"),year:this.month.year(),eventsThisMonth:this.eventsThisMonth,eventsLastMonth:this.eventsLastMonth,eventsNextMonth:this.eventsNextMonth,extras:this.options.extras});if(this.calendarContainer.html(this.options.render?this.options.render.apply(this,[c]):this.compiledClndrTemplate(c)),this.options.constraints){for(var d in this.options.targets)d!=this.options.targets.day&&this.element.find("."+this.options.targets[d]).toggleClass(this.options.classes.inactive,!1);var e=null,f=null;this.options.constraints.startDate&&(e=b(this.options.constraints.startDate)),this.options.constraints.endDate&&(f=b(this.options.constraints.endDate)),e&&this.month.isSame(e,"month")&&this.element.find("."+this.options.targets.previousButton).toggleClass(this.options.classes.inactive,!0),f&&this.month.isSame(f,"month")&&this.element.find("."+this.options.targets.nextButton).toggleClass(this.options.classes.inactive,!0),e&&b(e).subtract(1,"years").isBefore(b(this.month).subtract(1,"years"))&&this.element.find("."+this.options.targets.previousYearButton).toggleClass(this.options.classes.inactive,!0),f&&b(f).add(1,"years").isAfter(b(this.month).add(1,"years"))&&this.element.find("."+this.options.targets.nextYearButton).toggleClass(this.options.classes.inactive,!0),(e&&e.isAfter(b(),"month")||f&&f.isBefore(b(),"month"))&&this.element.find("."+this.options.targets.today).toggleClass(this.options.classes.inactive,!0)}this.options.doneRendering&&this.options.doneRendering.apply(this,[])},c.prototype.bindEvents=function(){var b=a(this.element),c=this;b.on("click","."+this.options.targets.day,function(b){if(c.options.clickEvents.click){var d=c.buildTargetObject(b.currentTarget,!0);c.options.clickEvents.click.apply(c,[d])}c.options.adjacentDaysChangeMonth&&(a(b.currentTarget).is("."+c.options.classes.lastMonth)?c.backActionWithContext(c):a(b.currentTarget).is("."+c.options.classes.nextMonth)&&c.forwardActionWithContext(c))}),b.on("click","."+this.options.targets.empty,function(b){if(c.options.clickEvents.click){var d=c.buildTargetObject(b.currentTarget,!1);c.options.clickEvents.click.apply(c,[d])}c.options.adjacentDaysChangeMonth&&(a(b.currentTarget).is("."+c.options.classes.lastMonth)?c.backActionWithContext(c):a(b.currentTarget).is("."+c.options.classes.nextMonth)&&c.forwardActionWithContext(c))}),b.on("click","."+this.options.targets.previousButton,{context:this},this.backAction).on("click","."+this.options.targets.nextButton,{context:this},this.forwardAction).on("click","."+this.options.targets.todayButton,{context:this},this.todayAction).on("click","."+this.options.targets.nextYearButton,{context:this},this.nextYearAction).on("click","."+this.options.targets.previousYearButton,{context:this},this.previousYearAction)},c.prototype.buildTargetObject=function(c,d){var e={element:c,events:[],date:null};if(d){var f,g=c.className.indexOf("calendar-day-");0!==g?(f=c.className.substring(g+13,g+23),e.date=b(f)):e.date=null,this.options.events&&(e.events=a.makeArray(this.options.multiDayEvents?a(this.options.events).filter(function(){return(e.date.isSame(this._clndrStartDateObject,"day")||e.date.isAfter(this._clndrStartDateObject,"day"))&&(e.date.isSame(this._clndrEndDateObject,"day")||e.date.isBefore(this._clndrEndDateObject,"day"))}):a(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM-DD")==f})))}return e},c.prototype.forwardAction=function(a){var b=a.data.context;b.forwardActionWithContext(b)},c.prototype.backAction=function(a){var b=a.data.context;b.backActionWithContext(b)},c.prototype.backActionWithContext=function(a){if(!a.element.find("."+a.options.targets.previousButton).hasClass("inactive")){var c=!a.month.isSame(b(a.month).subtract(1,"months"),"year");a.month.subtract(1,"months"),a.render(),a.options.clickEvents.previousMonth&&a.options.clickEvents.previousMonth.apply(a,[b(a.month)]),a.options.clickEvents.onMonthChange&&a.options.clickEvents.onMonthChange.apply(a,[b(a.month)]),c&&a.options.clickEvents.onYearChange&&a.options.clickEvents.onYearChange.apply(a,[b(a.month)])}},c.prototype.forwardActionWithContext=function(a){if(!a.element.find("."+a.options.targets.nextButton).hasClass("inactive")){var c=!a.month.isSame(b(a.month).add(1,"months"),"year");a.month.add(1,"months"),a.render(),a.options.clickEvents.nextMonth&&a.options.clickEvents.nextMonth.apply(a,[b(a.month)]),a.options.clickEvents.onMonthChange&&a.options.clickEvents.onMonthChange.apply(a,[b(a.month)]),c&&a.options.clickEvents.onYearChange&&a.options.clickEvents.onYearChange.apply(a,[b(a.month)])}},c.prototype.todayAction=function(a){var c=a.data.context,d=!c.month.isSame(b(),"month"),e=!c.month.isSame(b(),"year");c.month=b().startOf("month"),c.options.clickEvents.today&&c.options.clickEvents.today.apply(c,[b(c.month)]),d&&(c.render(),c.month=b(),c.options.clickEvents.onMonthChange&&c.options.clickEvents.onMonthChange.apply(c,[b(c.month)]),e&&c.options.clickEvents.onYearChange&&c.options.clickEvents.onYearChange.apply(c,[b(c.month)]))},c.prototype.nextYearAction=function(a){var c=a.data.context;c.element.find("."+c.options.targets.nextYearButton).hasClass("inactive")||(c.month.add(1,"years"),c.render(),c.options.clickEvents.nextYear&&c.options.clickEvents.nextYear.apply(c,[b(c.month)]),c.options.clickEvents.onMonthChange&&c.options.clickEvents.onMonthChange.apply(c,[b(c.month)]),c.options.clickEvents.onYearChange&&c.options.clickEvents.onYearChange.apply(c,[b(c.month)]))},c.prototype.previousYearAction=function(a){var c=a.data.context;c.element.find("."+c.options.targets.previousYear).hasClass("inactive")||(c.month.subtract(1,"years"),c.render(),c.options.clickEvents.previousYear&&c.options.clickEvents.previousYear.apply(c,[b(c.month)]),c.options.clickEvents.onMonthChange&&c.options.clickEvents.onMonthChange.apply(c,[b(c.month)]),c.options.clickEvents.onYearChange&&c.options.clickEvents.onYearChange.apply(c,[b(c.month)]))},c.prototype.forward=function(a){return this.month.add(1,"months"),this.render(),a&&a.withCallbacks&&(this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[b(this.month)]),0===this.month.month()&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[b(this.month)])),this},c.prototype.back=function(a){return this.month.subtract(1,"months"),this.render(),a&&a.withCallbacks&&(this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[b(this.month)]),11===this.month.month()&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[b(this.month)])),this},c.prototype.next=function(a){return this.forward(a),this},c.prototype.previous=function(a){return this.back(a),this},c.prototype.setMonth=function(a,c){return this.month.month(a),this.render(),c&&c.withCallbacks&&this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[b(this.month)]),this},c.prototype.nextYear=function(a){return this.month.add(1,"year"),this.render(),a&&a.withCallbacks&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[b(this.month)]),this},c.prototype.previousYear=function(a){return this.month.subtract(1,"year"),this.render(),a&&a.withCallbacks&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[b(this.month)]),this},c.prototype.setYear=function(a,c){return this.month.year(a),this.render(),c&&c.withCallbacks&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[b(this.month)]),this},c.prototype.setEvents=function(a){return this.options.events=this.options.multiDayEvents?this.addMultiDayMomentObjectsToEvents(a):this.addMomentObjectToEvents(a),this.render(),this},c.prototype.addEvents=function(b){return this.options.events=this.options.multiDayEvents?a.merge(this.options.events,this.addMultiDayMomentObjectsToEvents(b)):a.merge(this.options.events,this.addMomentObjectToEvents(b)),this.render(),this},c.prototype.removeEvents=function(a){for(var b=this.options.events.length-1;b>=0;b--)1==a(this.options.events[b])&&this.options.events.splice(b,1);return this.render(),this},c.prototype.addMomentObjectToEvents=function(a){var c=this,d=0,e=a.length;for(d;e>d;d++)a[d]._clndrDateObject=b(a[d][c.options.dateParameter]);return a},c.prototype.addMultiDayMomentObjectsToEvents=function(a){var c=this,d=0,e=a.length;for(d;e>d;d++)a[d][c.options.multiDayEvents.endDate]||a[d][c.options.multiDayEvents.startDate]?(a[d]._clndrEndDateObject=b(a[d][c.options.multiDayEvents.endDate]||a[d][c.options.multiDayEvents.startDate]),a[d]._clndrStartDateObject=b(a[d][c.options.multiDayEvents.startDate]||a[d][c.options.multiDayEvents.endDate])):(a[d]._clndrEndDateObject=b(a[d][c.options.multiDayEvents.singleDay]),a[d]._clndrStartDateObject=b(a[d][c.options.multiDayEvents.singleDay]));return a},c.prototype.calendarDay=function(b){var c={day:"",classes:this.options.targets.empty,events:[],date:null};return a.extend({},c,b)},a.fn.clndr=function(a){if(1===this.length){if(!this.data("plugin_clndr")){var b=new c(this,a);return this.data("plugin_clndr",b),b}}else if(this.length>1)throw new Error("CLNDR does not support multiple elements yet. Make sure your clndr selector returns only one element.")}});
>>>>>>> master
